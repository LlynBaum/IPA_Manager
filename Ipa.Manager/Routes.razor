@using Microsoft.AspNetCore.Components.Authorization
@using Ipa.Manager.Components

<
@if (IsLoginPage)
{
    <Router AppAssembly="@typeof(App).Assembly">
        <Found Context="routeData">
            <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)" />
        </Found>
    </Router>
}
else
{
    <AuthorizeView>
        <Authorized>
            <Router AppAssembly="@typeof(App).Assembly">
                <Found Context="routeData">
                    <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)" />
                </Found>
            </Router>
        </Authorized>

        <NotAuthorized>
            <RedirectToLogin />
        </NotAuthorized>
    </AuthorizeView>
}

@code {
    [Inject] NavigationManager Nav { get; set; } = default!;

    bool IsLoginPage => new Uri(Nav.Uri).AbsolutePath.Equals("/login", StringComparison.OrdinalIgnoreCase);
}

